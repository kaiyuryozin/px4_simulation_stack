uorb start
param load
param set MAV_TYPE 13
param set SYS_AUTOSTART 6001
param set SYS_RESTART_TYPE 2
param set SYS_MC_EST_GROUP 2
dataman start
param set BAT_N_CELLS 3
###########
## GYROs ##
###########
param set CAL_GYRO_PRIME 2293768
param set CAL_GYRO0_ID 2293768
param set CAL_GYRO0_XOFF 0.01
###########
## ACCs  ##
###########
param set CAL_ACC_PRIME 1376264
param set CAL_ACC0_ID 1376264
param set CAL_ACC0_XOFF 0.01
param set CAL_ACC0_YOFF -0.01
param set CAL_ACC0_ZOFF 0.01
param set CAL_ACC0_XSCALE 1.01
param set CAL_ACC0_YSCALE 1.01
param set CAL_ACC0_ZSCALE 1.01
param set CAL_ACC1_ID 1310728
param set CAL_ACC1_XOFF 0.01
###########
## MAGs  ##
###########
param set CAL_MAG_PRIME 196616 
param set CAL_MAG0_ID 196616
param set CAL_MAG0_XOFF 0.01
###########
## SENs  ##
###########
param set SENS_BOARD_ROT 0
param set SENS_BOARD_X_OFF 0.000001
###########
##  RTL  ##
###########
param set RTL_RETURN_ALT 30.000000000000000000
param set RTL_DESCEND_ALT 10.000000000000000000
param set RTL_LAND_DELAY 0
#param set RTL_MIN_DIST 5.000000000000000000 #add
###########
##  ALT  ##
###########
#param set MIS_TAKEOFF_ALT 3.0 #add
#param set MIS_ALTMODE 1 #add
#########################################
##  MC (Muliticopter Attitude Control) ##
#########################################
param set MC_ROLL_P 6.500000000000000000 #6
#param set MC_ROLL_TC 0.200000002980232239 #add
param set MC_PITCH_P 6.500000000000000000 #6
#param set MC_YAW_P 2.799999952316284180 #add
param set MC_ROLLRATE_P 0.150000005960464478 #0.2
#param set MC_ROLLRATE_I 0.050000000745058060 #add
#param set MC_ROLLRATE_D 0.003000000026077032 #add
#param set MC_ROLLRATE_FF 0.000000000000000000 #add
#param set MC_ROLLRATE_MAX 220.000000000000000000 #add
#param set MC_RR_INT_LIM 0.300000011920928955 #add
param set MC_PITCHRATE_P 0.150000005960464478 #0.2
#param set MC_PITCHRATE_I 0.050000000745058060 #add
#param set MC_PITCHRATE_D 0.003000000026077032 #add
#param set MC_PITCHRATE_FF 0.000000000000000000 #add
#param set MC_YAWRATE_P 0.200000002980232239 #add
#param set MC_YAWRATE_I 0.100000001490116119 #add
#param set MC_YAWRATE_D 0.000000000000000000 #add
#param set MC_YAWRATE_FF 0.000000000000000000 #add
#param set MC_YAWRATE_MAX 200.000000000000000000 #add
#param set MC_YAWRAUTO_MAX 45.000000000000000000 #add
#param set MC_YR_INT_LIM 0.300000011920928955 #add
#########################################
##  MC (Muliticopter  Control) ##
#########################################
param set MPC_HOLD_MAX_Z 0.600000023841857910 #2.0
param set MPC_Z_VEL_P 0.200000002980232239 #0.6
param set MPC_Z_VEL_I 0.019999999552965164 #0.15
param set MPC_XY_VEL_P 0.090000003576278687 #0.15
param set MPC_XY_VEL_I 0.019999999552965164 #0.2
param set EKF2_EKF2_GBIAS_INIT 0.100000001490116119 #0.01
param set EKF2_ANGERR_INIT 0.100000001490116119 #0.01
param set EKF2_MAG_TYPE 0 #1
param set SDLOG_DIRS_MAX 0
param set PWM_MAX 1950 #add
param set PWM_MIN 1075 #add
#param set PWM_DISARMED 900 #add
param set COM_RC_IN_MODE 1
param set NAV_DLL_ACT 2
param set COM_DISARM_LAND 3
#param set COM_TAKEOFF_ACT 0 #add
param set NAV_ACC_RAD 2.0
replay tryapplyparams
simulator start -s
tone_alarm start
gyrosim start
accelsim start
barosim start
adcsim start
gpssim start
pwm_out_sim mode_pwm16
sensors start
commander start
land_detector start multicopter
navigator start
attitude_estimator_q start
local_position_estimator start
mc_pos_control start
mc_att_control start
mixer load /dev/pwm_output0 ROMFS/px4fmu_common/mixers/hexa_x.main.mix
mavlink start -x -u 14556 -r 4000000
mavlink start -x -u 14557 -r 4000000 -m onboard -o 14540
mavlink stream -r 50 -s POSITION_TARGET_LOCAL_NED -u 14556
mavlink stream -r 50 -s LOCAL_POSITION_NED -u 14556
mavlink stream -r 50 -s GLOBAL_POSITION_INT -u 14556
mavlink stream -r 50 -s ATTITUDE -u 14556
mavlink stream -r 50 -s ATTITUDE_QUATERNION -u 14556
mavlink stream -r 50 -s ATTITUDE_TARGET -u 14556
mavlink stream -r 50 -s SERVO_OUTPUT_RAW_0 -u 14556
mavlink stream -r 20 -s RC_CHANNELS -u 14556
mavlink stream -r 250 -s HIGHRES_IMU -u 14556
mavlink stream -r 10 -s OPTICAL_FLOW_RAD -u 14556
logger start -e -t
vmount start
mavlink boot_complete
replay trystart
